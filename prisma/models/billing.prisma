// prisma/models/billing.prisma
model Subscription {
  id                   String              @id @default(uuid()) @db.Uuid
  clinicId             String?             @unique @map("clinic_id") @db.Uuid
  stripeCustomerId     String?             @unique @map("stripe_customer_id") @db.VarChar
  stripeSubscriptionId String?             @unique @map("stripe_subscription_id") @db.VarChar
  plan                 Plan?
  status               SubscriptionStatus?
  currentPeriodStart   DateTime?           @map("current_period_start") @db.Timestamptz(6)
  currentPeriodEnd     DateTime?           @map("current_period_end") @db.Timestamptz(6)
  createdAt            DateTime?           @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt            DateTime?           @updatedAt @map("updated_at") @db.Timestamp(6)

  clinic Clinic? @relation(fields: [clinicId], references: [id])

  @@map("subscriptions")
}

model Invoice {
  id              String    @id @default(uuid()) @db.Uuid
  clinicId        String?   @map("clinic_id") @db.Uuid
  stripeInvoiceId String?   @unique @map("stripe_invoice_id") @db.VarChar
  invoiceNo       String?   @map("invoice_no") @db.VarChar
  amountDue       Int?      @map("amount_due")
  amountPaid      Int?      @map("amount_paid")
  currency        String?   @db.VarChar
  status          String?   @db.VarChar
  invoicePdfUrl   String?   @map("invoice_pdf_url") @db.VarChar
  createdAt       DateTime? @default(now()) @map("created_at") @db.Timestamp(6)

  clinic Clinic? @relation(fields: [clinicId], references: [id])

  @@map("invoices")
}

model NotificationQueue {
  id        String              @id @default(uuid()) @db.Uuid
  clinicId  String?             @map("clinic_id") @db.Uuid
  type      NotificationType?
  recipient String?             @db.VarChar
  payload   Json?               @db.Json
  status    NotificationStatus?
  sentAt    DateTime?           @map("sent_at") @db.Timestamp(6)
  createdAt DateTime?           @default(now()) @map("created_at") @db.Timestamp(6)

  clinic Clinic? @relation(fields: [clinicId], references: [id])

  @@map("notification_queues")
}
model Admin {
  id           String  @id @default(uuid()) @db.Uuid
  clinicId     String? @map("clinic_id") @db.Uuid
  email        String? @unique @db.VarChar
  passwordHash String? @map("password_hash") @db.VarChar
  firstName    String? @map("first_name") @db.VarChar
  lastName     String? @map("last_name") @db.VarChar
  otp          String?

  emailVerifiedAt  DateTime? @map("email_verified_at") @db.Timestamp(6)
  twoFactorSecret  String?   @map("two_factor_secret") @db.VarChar
  twoFactorEnabled Boolean?  @map("two_factor_enabled")
  lastLoginAt      DateTime? @map("last_login_at") @db.Timestamp(6)
  createdAt        DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt        DateTime? @updatedAt @map("updated_at") @db.Timestamp(6)
  deletedAt        DateTime? @map("deleted_at") @db.Timestamp(6)

  // Relations
  clinic        Clinic?    @relation(fields: [clinicId], references: [id])
  sessions      Session[]
  auditLogs     AuditLog[]
  assignedTasks Task[]     @relation("AdminTaskAssignee")

  @@map("admins")
}

model Doctor {
  id           String  @id @default(uuid()) @db.Uuid
  clinicId     String? @map("clinic_id") @db.Uuid
  email        String? @unique @db.VarChar
  passwordHash String? @map("password_hash") @db.VarChar
  firstName    String? @map("first_name") @db.VarChar
  lastName     String? @map("last_name") @db.VarChar
  otp          String?

  // Doctor Specific Fields
  licenceNo    String?  @map("licence_no") @db.VarChar
  specialities String[] @db.VarChar

  emailVerifiedAt  DateTime? @map("email_verified_at") @db.Timestamp(6)
  twoFactorSecret  String?   @map("two_factor_secret") @db.VarChar
  twoFactorEnabled Boolean?  @map("two_factor_enabled")
  lastLoginAt      DateTime? @map("last_login_at") @db.Timestamp(6)
  createdAt        DateTime? @default(now()) @map("created_at") @db.Timestamp(6)
  updatedAt        DateTime? @updatedAt @map("updated_at") @db.Timestamp(6)
  deletedAt        DateTime? @map("deleted_at") @db.Timestamp(6)

  // Relations
  clinic        Clinic?        @relation(fields: [clinicId], references: [id])
  sessions      Session[]
  appointments  Appointment[]  @relation("DoctorAppointments")
  calls         Call[]         @relation("DoctorCalls")
  prescriptions Prescription[] @relation("DoctorPrescriptions")
  diagnoses     Diagnosis[]    @relation("DoctorDiagnoses")
  assignedTasks Task[]         @relation("DoctorTaskAssignee")
  auditLogs     AuditLog[]

  // HR Relations
  staffPersonalInfo   StaffPersonalInfo?
  staffEmploymentInfo StaffEmploymentInfo?

  // Self-relation for reporting hierarchy
  subordinates StaffEmploymentInfo[] @relation("ReportingManager")

  @@map("doctors")
}

model Session {
  id        String    @id @default(uuid()) @db.Uuid
  adminId   String?   @map("admin_id") @db.Uuid
  doctorId  String?   @map("doctor_id") @db.Uuid
  ip        String?   @db.Inet
  userAgent String?   @map("user_agent") @db.VarChar
  createdAt DateTime? @default(now()) @map("created_at") @db.Timestamp(6)

  admin  Admin?  @relation(fields: [adminId], references: [id])
  doctor Doctor? @relation(fields: [doctorId], references: [id])

  @@map("sessions")
}
